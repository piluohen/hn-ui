<div class="hn-search">
  <div *ngIf="render" class="hn-search-simple">
    <ng-template [ngTemplateOutlet]="render">
    </ng-template>
  </div>
  <div *ngIf="!render" class="hn-search-simple">
    <nz-input-group nzSearch [nzAddOnAfter]="suffixIconSearch">
      <input
        type="text"
        nz-input
        [(ngModel)]="form[keyword]"
        maxlength="30"
        [placeholder]="placeholder"
        (keyup.enter)="handleKeyupEnter()" />
    </nz-input-group>
    <ng-template #suffixIconSearch>
      <button nz-button nzType="primary" nzSearch (click)="handleKeyupEnter()">
        <i nz-icon type="search"></i>搜索
      </button>
    </ng-template>
    <button
      *ngIf="formList && formList.length > 0"
      nz-button
      nzType="link"
      (click)="handleToggle()">高级搜索
      <i nz-icon [nzType]="modeVisible ? 'up' : 'down'" nzTheme="outline"></i>
    </button>
  </div>
  <div class="search-popover" *ngIf="modeVisible">
    <form class="search-popover-form" nz-form nzLayout="horizontal" [formGroup]="validateForm">
      <div nz-row [nzGutter]="20">
        <div nz-col [nzSpan]="item.col || 6" *ngFor="let item of formList">
          <nz-form-item nzFlex>
            <nz-form-label nzFor="note">{{item.label.title || item.label}}</nz-form-label>
            <nz-form-control style="flex: 1;">
              <input
                *ngIf="item.type === 'input'"
                type="text"
                nz-input
                maxlength="30"
                [formControlName]="item.key" />
              <nz-range-picker
                *ngIf="item.type === 'range'"
                [nzDisabledDate]="item.disabledDate"
                [nzDisabledTime]="item.disabledTime"
                [formControlName]="item.key"></nz-range-picker>
              <nz-date-picker
                *ngIf="item.type === 'date'"
                [nzDisabledDate]="item.disabledDate"
                [nzDisabledTime]="item.disabledTime"
                [formControlName]="item.key"></nz-date-picker>
              <nz-month-picker
                *ngIf="item.type === 'month'"
                [formControlName]="item.key"
                [nzPlaceHolder]="item.placeholder"></nz-month-picker>
              <nz-year-picker
                *ngIf="item.type === 'year'"
                [formControlName]="item.key"
                [nzPlaceHolder]="item.placeholder"></nz-year-picker>
              <nz-checkbox-group
                *ngIf="item.type === 'checkbox'"
                [formControlName]="item.key"></nz-checkbox-group>
              <nz-select
                *ngIf="item.type === 'select'"
                [nzAllowClear]="true"
                [formControlName]="item.key">
                <nz-option *ngFor="let item of item.options" [nzValue]="item.value" [nzLabel]="item.label">
                </nz-option>
              </nz-select>
              <nz-tree-select
                *ngIf="item.type === 'tree-select'"
                [nzNodes]="item.options"
                nzShowSearch
                nzCheckable
                [formControlName]="item.key">
              </nz-tree-select>
              <nz-cascader
                *ngIf="item.type === 'cascader'"
                [nzOptions]="item.options"
                [nzValueProperty]="item.valueProperty || 'value'"
                [nzLabelProperty]="item.labelProperty || 'label'"
                [formControlName]="item.key"
                [nzPlaceHolder]="item.placeholder || '请选择'"></nz-cascader>
              <div *ngIf="item.children" class="search-children">
                <div class="search-children-item" *ngFor="let v of item.children">
                  <input
                    *ngIf="v.type === 'input'"
                    type="text"
                    nz-input
                    maxlength="30"
                    [formControlName]="v.key" />
                  <nz-input-number
                    *ngIf="v.type === 'input-number'"
                    [formControlName]="v.key"
                    [nzPlaceHolder]="v.placeHolder"
                    [nzMin]="(v.options && v.options.min) || 1"
                    [nzMax]="(v.options && v.options.max) || 9999"
                    [nzStep]="(v.options && v.options.step) || 1"
                    [nzPrecision]="(v.options && v.options.precision) || 0.1"></nz-input-number>
                </div>
              </div>
            </nz-form-control>
          </nz-form-item>
        </div>
      </div>
    </form>
    <div class="search-popover-btns">
      <button nz-button nzType="primary" (click)="handleConfirm()">搜索</button>
      <button nz-button (click)="handleReset()">清空条件</button>
      <button nz-button nzType="link" (click)="handleCancle()">收起<i nz-icon nzType="up" nzTheme="outline"></i></button>
    </div>
  </div>
</div>